<!doctype html>
<html>
<head>
    <meta charset="utf-8">
    <title>test modal wrapper</title>
    <link href="../../bootstrap/css/bootstrap.css" rel="stylesheet" type="text/css" />
    <link href="modalwrapper.css" rel="stylesheet" type="text/css" />
    <script src="../../jquery/jquery-1.11.1.js" type="text/javascript"></script>
    <script src="../../bootstrap/js/bootstrap.js" type="text/javascript"></script>
    <script src="../../library/pluginmanager/pluginmanager.js" type="text/javascript"></script>
    <script src="modalwrapper_init.js" type="text/javascript"></script>
    <script src="modalwrapper_confirm.js" type="text/javascript"></script>
    <script src="modalwrapper_alert.js" type="text/javascript"></script>
</head>
<body>
    <input id="button1" type="button" value="testModal" />
    <input id="button2" type="button" value="testConfirm" />
    <div id="container"></div>
    <script>
        $(function () {

            $('#button1').click(function () {
                $('#container').modalWrapper('init', {
                    width: '800px',
                    title: {
                        text: 'Modal Dialog',
                        closeClick: function (closeModal) {
                            alert();
                            closeModal();
                        }
                    },
                    body: '<div style="height:500px;">内容</div>',
                    footer: {
                        html:
                                '<button type="button" class="btn btn-default">\
                                    关闭\
                                </button>\
                                <button type="button" class="btn btn-primary">\
                                    提交\
                                </button>',
                        selector: '>button',
                        eventType: 'click',
                        handler: function (closeModal) {
                            handleModalDialogClickEvent.call(this, closeModal);
                        }
                    }
                })
                .modalWrapper('show');
            });

            $('#button2').click(function () {
                $().modalWrapper('confirm', {
                    title: 'Confirm Dialog',
                    message: '确定提交吗？',
                    yes: {
                        text: 'YES',
                        callback: function (closeConfirm) {
                            alert(true);
                            closeConfirm();
                        }
                    },
                    no: {
                        text: 'NO',
                        callback: function (closeConfirm) {
                            alert(false);
                            closeConfirm();
                        }
                    }
                });
            });

            function handleModalDialogClickEvent(closeModal) {
                var $button = $(this),
                    index = $button.index();

                switch (index) {
                    case 0:
                        closeModal();
                        break;

                    case 1:
                        $().modalWrapper('confirm', {
                            title: 'Confirm Dialog',
                            message: '确定提交吗？',
                            yes: {
                                text: 'YES',
                                callback: function (closeConfirm) {
                                    handleConfirmDialogClickEvent.call(null, closeModal, closeConfirm);
                                }
                            },
                            no: {
                                text: 'NO'
                            }
                        });
                        break;
                }
            }

            function handleConfirmDialogClickEvent(closeModal, closeConfirm) {
                $().modalWrapper('alert', {
                    title: 'Alert Dialog',
                    message: '真的确定吗？',
                    yes: {
                        text: 'YES',
                        callback: function (closeAlert) {
                            closeAlert();
                            closeConfirm();
                            closeModal();
                        }
                    }
                });
            }
        });
    </script>
</body>
</html>
